<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Create Quiz</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body {
  font-family: Arial, sans-serif;
  background: #f2f2f2;
  padding: 30px;
  text-align: center;
}

h1 {
  margin-bottom: 20px;
}

input {
  width: 300px;
  padding: 10px;
  margin: 5px 0;
  font-size: 16px;
}

/* Container for each question */
.question-box {
  background: #fff;
  border: 2px solid #aaa;
  border-radius: 8px;
  padding: 15px;
  max-width: 650px;
  margin: 20px auto;
  text-align: left;
}

/* Buttons grouped */
.button-group {
  display: flex;
  justify-content: center;
  gap: 10px;
  margin-bottom: 20px;
}

.button-group button {
  width: 140px;
  padding: 10px;
  font-size: 16px;
  cursor: pointer;
}
</style>
</head>

<body>

<h1>Create Your Own Quiz</h1>

<!-- Quiz title -->
<input type="text" id="quizTitle" placeholder="Quiz Title">

<!-- Questions container -->
<div id="questionsContainer"></div>

<!-- Buttons -->
<div class="button-group">
  <button onclick="addQuestionBox()">Add Question</button>
</div>

<div class="button-group">
  <button onclick="saveQuiz()">Save Quiz</button>
  <button onclick="playCurrentQuiz()">Play Current Quiz</button>
</div>

<div class="button-group">
  <button onclick="archiveCurrentQuiz()">Archive Quiz</button>
  <button onclick="deleteCurrentQuiz()">Delete Quiz</button>
</div>

<div class="button-group">
  <button onclick="window.location.href='my-quizzes.html'">My Quizzes</button>
</div>

<script>
let questions = [];

/* ADD QUESTION BOX */
function addQuestionBox() {
  const container = document.getElementById("questionsContainer");

  const qIndex = questions.length;
  questions.push({ question: "", correct: "", wrong1: "", wrong2: "", wrong3: "" });

  const box = document.createElement("div");
  box.className = "question-box";
  box.id = "questionBox" + qIndex;

  box.innerHTML = `
    <b>Question ${qIndex + 1}</b><br>
    <input type="text" placeholder="Question text" oninput="questions[${qIndex}].question=this.value"><br>
    <input type="text" placeholder="Correct answer" oninput="questions[${qIndex}].correct=this.value"><br>
    <input type="text" placeholder="Wrong answer 1" oninput="questions[${qIndex}].wrong1=this.value"><br>
    <input type="text" placeholder="Wrong answer 2" oninput="questions[${qIndex}].wrong2=this.value"><br>
    <input type="text" placeholder="Wrong answer 3" oninput="questions[${qIndex}].wrong3=this.value"><br>
  `;

  container.appendChild(box);
}

/* SAVE QUIZ */
function saveQuiz() {
  const title = document.getElementById("quizTitle").value.trim();
  if (!title) { alert("Enter quiz title"); return; }
  if (questions.length === 0) { alert("Add at least one question"); return; }

  // Convert to standard format for game
  const formattedQuestions = questions.map(q => ({
    question: q.question,
    correct: q.correct,
    choices: [q.correct, q.wrong1, q.wrong2, q.wrong3].sort(() => Math.random() - 0.5)
  }));

  const quizzes = JSON.parse(localStorage.getItem("myQuizzes") || "[]");
  quizzes.push({ title, questions: formattedQuestions });
  localStorage.setItem("myQuizzes", JSON.stringify(quizzes));

  alert("Quiz saved!");
  location.href = "my-quizzes.html";
}

/* PLAY CURRENT QUIZ */
function playCurrentQuiz() {
  const title = document.getElementById("quizTitle").value.trim();
  if (!title) { alert("Enter quiz title"); return; }
  if (questions.length === 0) { alert("Add questions"); return; }

  const formattedQuestions = questions.map(q => ({
    question: q.question,
    correct: q.correct,
    choices: [q.correct, q.wrong1, q.wrong2, q.wrong3].sort(() => Math.random() - 0.5)
  }));

  sessionStorage.setItem("currentQuiz", JSON.stringify({ title, questions: formattedQuestions }));
  location.href = "game.html";
}

/* ARCHIVE CURRENT QUIZ */
function archiveCurrentQuiz() {
  const title = document.getElementById("quizTitle").value.trim();
  if (!title || questions.length === 0) { alert("Nothing to archive"); return; }

  const formattedQuestions = questions.map(q => ({
    question: q.question,
    correct: q.correct,
    choices: [q.correct, q.wrong1, q.wrong2, q.wrong3].sort(() => Math.random() - 0.5)
  }));

  const archived = JSON.parse(localStorage.getItem("archivedQuizzes") || "[]");
  archived.push({ title, questions: formattedQuestions });
  localStorage.setItem("archivedQuizzes", JSON.stringify(archived));

  clearQuiz();
  alert("Quiz archived");
}

/* DELETE CURRENT QUIZ */
function deleteCurrentQuiz() {
  if (!confirm("Delete current quiz?")) return;
  clearQuiz();
}

/* CLEAR QUIZ */
function clearQuiz() {
  questions = [];
  document.getElementById("quizTitle").value = "";
  document.getElementById("questionsContainer").innerHTML = "";
}
</script>

</body>
</html>
