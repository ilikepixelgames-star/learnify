<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Quiz Game</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
  body { font-family: Arial; text-align:center; margin-top:40px; background:#f4f6fb; }
  button { padding:12px 24px; margin:8px; cursor:pointer; border-radius:10px; border:none; background:#4f46e5; color:white; }
  button:disabled{background:#999;}
  #answers button { display:block; margin:10px auto; width:60%; }
</style>
</head>
<body>

<h1 id="q-title"></h1>
<p id="q-text"></p>
<div id="answers"></div>
<div id="leaderboard" style="display:none;">
  <h2>üèÜ Leaderboard</h2>
  <p id="top3"></p>
  <p><strong>Your Score:</strong> <span id="your-score"></span></p>
</div>
<button id="next-btn" style="display:none;">Next Question</button>
<button id="lobby-btn">‚¨ÖÔ∏è Back to Lobby</button>

<script>
let questions = JSON.parse(sessionStorage.getItem("currentQuiz") || "[]");

const title=document.getElementById("q-title");
const qText=document.getElementById("q-text");
const ansDiv=document.getElementById("answers");
const nextBtn=document.getElementById("next-btn");
const lobbyBtn=document.getElementById("lobby-btn");
const leaderboard=document.getElementById("leaderboard");
const top3El=document.getElementById("top3");
const yourScoreEl=document.getElementById("your-score");

if(questions.length===0){
  title.textContent="No quiz loaded!";
  qText.textContent="Go back and create a quiz first.";
}

let index=0;
let score=0;
let players=[{name:"YOU",score:0}];
const simNames=["Alex","Jamie","Sam","Taylor","Jordan","Chris","Morgan","Riley","Casey"];
simNames.forEach(n=>players.push({name:n, score:Math.floor(Math.random()*300)}));

function loadQuestion(){
  if(questions.length===0) return;
  ansDiv.innerHTML="";
  title.textContent=`Question ${index+1}`;
  qText.textContent=questions[index].q;
  questions[index].answers.forEach((a,i)=>{
    const b=document.createElement("button");
    b.textContent=a;
    b.onclick=()=>answer(i);
    ansDiv.appendChild(b);
  });
  nextBtn.style.display="none";
}

function answer(choice){
  ansDiv.querySelectorAll("button").forEach(b=>b.disabled=true);
  if(choice===questions[index].correct) score+=1000;
  for(let i=1;i<players.length;i++){ if(Math.random()<0.6) players[i].score+=Math.floor(600+Math.random()*500); }
  showLeaderboard();
}

function showLeaderboard(){
  players.sort((a,b)=>b.score-a.score);
  const top3=players.slice(0,3).map((p,i)=>`${i+1}Ô∏è‚É£ ${p.name} ‚Äî ${p.score} pts`).join("<br>");
  top3El.innerHTML=top3;
  yourScoreEl.textContent=players[0].score;
  leaderboard.style.display="block";
  nextBtn.style.display="inline-block";
}

nextBtn.onclick=()=>{
  index++;
  if(index<questions.length) loadQuestion();
  else{
    title.textContent="üéâ Quiz Complete!";
    qText.textContent="Score: "+players[0].score;
    ansDiv.innerHTML="";
    nextBtn.style.display="none";
  }
};

lobbyBtn.addEventListener("click", ()=>window.location.href="lobby.html");

if(questions.length>0) loadQuestion();
</script>
</body>
</html>
